import{N as s}from"./Net-DoGrRJ2L.js";import{_ as u,c as h,y as o,o as p,v as t,a3 as _,z as l,ak as V,F as D,G as d,V as k}from"./index-D5RChKJd.js";import{V as f}from"./VContainer-CtLK66NM.js";import{V as y}from"./VForm-C5Vb8gCT.js";import{V as F,a as m}from"./VRow-cXHPaD9I.js";import{V as b}from"./VSelect-Bdam0HV5.js";import{V as c}from"./VTextField-CnTQvUdV.js";import"./TokenModel-epR9isAp.js";import"./VList-CjBwifb_.js";import"./index-D7NUcBGC.js";import"./VDivider-hyp4xJKF.js";import"./VVirtualScroll-B8tTxoa3.js";import"./VSlideGroup-ChQmK8CO.js";const I={data(){return{teamList:[],coinList:[],selectedCoinId:null,formData:{id:null,name:"测试key名称，随便起一个",team_id:"",prefix:"",amount:"-1",from_id:"1"}}},methods:{async fetchTeamInfo(){const e=await new s("/v1/user/team/list").PostFormData();e.code===0?this.teamList=e.GetTeamList():console.error(e.echo)},async fetchInfo(){try{const e=await new s("/v1/team/subtoken/get").PostFormData(this.formData);e.code===0?this.formData=e.data:console.error("Failed to fetch iflytek info:",e.echo)}catch(e){console.error("Failed to fetch iflytek info:",e)}},async fetchCoinList(){try{const e=await new s("/v1/coin/info/list").PostFormData();e.code===0?this.coinList=e.GetTeamList():console.error("Failed to fetch coin list:",e.echo)}catch(e){console.error("Failed to fetch coin list:",e)}},async updateToken(){try{const e={name:this.formData.name,id:this.formData.id,team_id:this.formData.team_id,coin_id:this.selectedCoinId,prefix:this.formData.prefix,amount:this.formData.amount,from_id:this.formData.from_id},a=await new s("/v1/team/subtoken/update").PostFormData(e);a.code===0?this.goBack():console.error("Failed to create token:",a.echo)}catch(e){console.error("Failed to create token:",e)}},goBack(){this.$router.push({path:"/v1/team",query:{tab:"subtoken"}})}},mounted(){this.formData.id=parseInt(this.$route.query.id),isNaN(this.formData.id)&&console.error("Invalid id ID:",this.$route.query.id),this.formData.team_id=parseInt(this.$route.query.team_id),isNaN(this.formData.team_id)&&console.error("Invalid team_id ID:",this.$route.query.team_id),this.fetchTeamInfo(),this.fetchInfo()}};function w(e,a,x,C,r,n){return p(),h(f,null,{default:o(()=>[t(k,null,{default:o(()=>[t(_,null,{default:o(()=>[l(" 添加团队 Token ")]),_:1}),t(V,null,{default:o(()=>[t(y,{onSubmit:D(n.updateToken,["prevent"])},{default:o(()=>[t(f,null,{default:o(()=>[t(F,null,{default:o(()=>[t(m,{cols:"12"},{default:o(()=>[t(b,{modelValue:r.formData.team_id,"onUpdate:modelValue":a[0]||(a[0]=i=>r.formData.team_id=i),items:r.teamList,label:"团队id","item-text":"title","item-value":"id"},null,8,["modelValue","items"])]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(c,{modelValue:r.formData.name,"onUpdate:modelValue":a[1]||(a[1]=i=>r.formData.name=i),label:"key名称"},null,8,["modelValue"])]),_:1}),t(m,{cols:"12"},{default:o(()=>[t(c,{modelValue:r.formData.amount,"onUpdate:modelValue":a[2]||(a[2]=i=>r.formData.amount=i),label:"可以使用的余额,如果是-1就是无线，大于0就按正常的扣"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(d,{type:"submit",color:"primary",block:"",class:"mt-4"},{default:o(()=>[l("添加")]),_:1}),t(d,{onClick:n.goBack,color:"grey",block:"",class:"mt-4"},{default:o(()=>[l("返回")]),_:1},8,["onClick"])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})}const R=u(I,[["render",w]]);export{R as default};
